{
    "dataset" : {
        "type" : "Cityscapes",
        "rootdir" : "/media/bryce/4TB Seagate/Autonomous Vehicles Data/Cityscapes Data/",
        "batch_size" : 2,
        "shuffle" : true,
        "drop_last" : true,
        "augmentations" : {
            "crop_fraction" : 1,
            "output_size" : [1024, 512]
        },
        "train_subdirs" : {
            "images" : "leftImg8bit/train",
            "left_seq" : "leftImg8bit_sequence/train",
            "seg" : "gtFine/train"
        },
        "val_subdirs" : {
            "images" : "leftImg8bit/val",
            "left_seq" : "leftImg8bit_sequence/val",
            "seg" : "gtFine/val"
        }
    },
    "loss_functions" : [
        {"flow" : {
            "function" : "unFlowLoss",
            "args" : {
                "l1":0.15, "ssim":0.85
            }
        }},
        {"segmentation" : {
            "function" : "FocalLoss2D",
            "args" : {
                "gamma": 2, "ignore_index" : -1,
                "dynamic_weights" : true, "weight_scale" : 0.125
            }
        }}
    ],
    "trainer" : "MonoSegFlowTrainer",
    "model" : {
        "name" : "MonoSFNet",
        "args" : {
            "feature_pyramid_extractor" : {
                "type" : "FeatureExtractor",
                "args" : {
                    "channels" : [3, 16, 32, 64, 96, 128, 192]
                }
            },
            "segmentation_network": {
                "type" : "SegmentationNet3",
                "args" : {
                    "classes" : 19
                }
            },
            "correlation_args" : {
                "pad_size" : 4,
                "max_displacement" : 4,
                "kernel_size" : 1,
                "stride 1" : 1,
                "stride 2" : 1,
                "corr_multiply" : 1
            },
            "flow_est_network" : {
                "type" : "FlowEstimatorDense",
                "args" : {}
            },
            "context_network" : {
                "type" : "ContextNetwork",
                "args" : {}
            },
            "1x1_conv_out" : 32
        }
    },
    "optimiser" : {
        "type" : "Adam",
        "args" : {
            "betas":[0.9, 0.99], "lr":1e-4, "weight_decay":1e-6
        }
    },
    "lr_scheduler" : {
        "lr" : 1e-4, "mode" : "constant"
    }
}